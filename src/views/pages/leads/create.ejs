<!-- Header -->
<div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8">
  <div>
    <div class="text-sm text-muted mb-1">Leads / Nouveau</div>
    <h1 class="text-2xl md:text-3xl font-bold">Ajouter un lead</h1>
  </div>
</div>

<!-- Flash messages -->
<%- include('../../partials/flash') %>

<!-- Form -->
<div class="bg-card rounded-2xl p-6 md:p-8 shadow-sm border border-border">
  <form method="POST" action="/leads" class="space-y-6">
    <div class="space-y-2">
      <label class="block text-sm font-semibold text-primary">Email *</label>
      <input 
        type="email" 
        name="email" 
        value="<%= typeof formData !== 'undefined' ? (formData.email || '') : '' %>"
        placeholder="email@example.com" 
        class="w-full bg-background border border-border rounded-xl px-4 py-3 outline-none focus:border-primary focus:ring-2 focus:ring-primary/10 text-primary placeholder:text-muted"
        required
      >
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="space-y-2">
        <label class="block text-sm font-semibold text-primary">Prénom</label>
        <input 
          type="text" 
          name="firstName" 
          value="<%= typeof formData !== 'undefined' ? (formData.firstName || '') : '' %>"
          placeholder="Prénom" 
          class="w-full bg-background border border-border rounded-xl px-4 py-3 outline-none focus:border-primary focus:ring-2 focus:ring-primary/10 text-primary placeholder:text-muted"
        >
      </div>

      <div class="space-y-2">
        <label class="block text-sm font-semibold text-primary">Nom</label>
        <input 
          type="text" 
          name="lastName" 
          value="<%= typeof formData !== 'undefined' ? (formData.lastName || '') : '' %>"
          placeholder="Nom" 
          class="w-full bg-background border border-border rounded-xl px-4 py-3 outline-none focus:border-primary focus:ring-2 focus:ring-primary/10 text-primary placeholder:text-muted"
        >
      </div>
    </div>

    <div class="space-y-2">
      <label class="block text-sm font-semibold text-primary">Téléphone</label>
      <input 
        type="tel" 
        name="phone" 
        value="<%= typeof formData !== 'undefined' ? (formData.phone || '') : '' %>"
        placeholder="+33 6 12 34 56 78" 
        class="w-full bg-background border border-border rounded-xl px-4 py-3 outline-none focus:border-primary focus:ring-2 focus:ring-primary/10 text-primary placeholder:text-muted"
      >
    </div>

    <div class="space-y-2">
      <label class="block text-sm font-semibold text-primary">Adresse</label>
      <input 
        type="text" 
        name="address" 
        value="<%= typeof formData !== 'undefined' ? (formData.address || '') : '' %>"
        placeholder="Adresse complète" 
        class="w-full bg-background border border-border rounded-xl px-4 py-3 outline-none focus:border-primary focus:ring-2 focus:ring-primary/10 text-primary placeholder:text-muted"
      >
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div class="space-y-2">
        <label class="block text-sm font-semibold text-primary">Code postal</label>
        <input 
          type="text" 
          name="postalCode" 
          value="<%= typeof formData !== 'undefined' ? (formData.postalCode || '') : '' %>"
          placeholder="75001" 
          class="w-full bg-background border border-border rounded-xl px-4 py-3 outline-none focus:border-primary focus:ring-2 focus:ring-primary/10 text-primary placeholder:text-muted"
        >
      </div>

      <div class="space-y-2">
        <label class="block text-sm font-semibold text-primary">Ville</label>
        <input 
          type="text" 
          name="city" 
          value="<%= typeof formData !== 'undefined' ? (formData.city || '') : '' %>"
          placeholder="Paris" 
          class="w-full bg-background border border-border rounded-xl px-4 py-3 outline-none focus:border-primary focus:ring-2 focus:ring-primary/10 text-primary placeholder:text-muted"
        >
      </div>
    </div>

    <div class="space-y-2">
      <label class="block text-sm font-semibold text-primary">Source (Campagnes)</label>
      <div class="space-y-2">
        <% if (landingPages && landingPages.length > 0) { %>
          <% landingPages.forEach(landingPage => { %>
            <label class="flex items-center gap-3 p-3 bg-background rounded-xl border border-border hover:border-primary transition cursor-pointer">
              <input 
                type="checkbox" 
                name="landingPages[]" 
                value="<%= landingPage.id %>"
                class="w-4 h-4 text-primary border-border rounded focus:ring-primary"
              >
              <div class="flex-1">
                <p class="font-semibold text-sm"><%= landingPage.name %></p>
                <p class="text-xs text-muted"><%= landingPage.description %></p>
              </div>
            </label>
          <% }) %>
        <% } else { %>
          <p class="text-muted text-sm">Aucune landing page disponible</p>
        <% } %>
      </div>
    </div>

    <div class="space-y-2">
      <label class="block text-sm font-semibold text-primary">Statut</label>
      <select 
        name="status" 
        class="w-full bg-background border border-border rounded-xl px-4 py-3 outline-none focus:border-primary focus:ring-2 focus:ring-primary/10 text-primary"
      >
        <option value="new" <%= (typeof formData !== 'undefined' && formData.status === 'new') ? 'selected' : '' %>>Nouveau</option>
        <option value="qualified" <%= (typeof formData !== 'undefined' && formData.status === 'qualified') ? 'selected' : '' %>>Qualifié</option>
        <option value="converted" <%= (typeof formData !== 'undefined' && formData.status === 'converted') ? 'selected' : '' %>>Converti</option>
      </select>
    </div>

    <div class="flex items-center gap-3 pt-4">
      <a href="/leads" class="px-6 py-3 rounded-xl border border-border text-muted hover:text-primary hover:border-primary transition font-semibold">
        Annuler
      </a>
      <button type="submit" class="flex-1 px-6 py-3 rounded-xl bg-primary text-white font-semibold hover:bg-primary/90 transition">
        Ajouter le lead
      </button>
    </div>
  </form>
</div>
